<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Doc Converter</title>
    <link rel="stylesheet" href="style.css">
    <!-- PDF.js for PDF parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <!-- JSZip for PPTX parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- docx library for DOCX generation (local copy for reliability) -->
    <script src="js/docx.umd.js"></script>
    <script>
        // Verify libraries are loaded
        window.addEventListener('load', function() {
            console.log('Libraries check:');
            console.log('- pdfjsLib:', typeof pdfjsLib !== 'undefined' ? 'loaded' : 'NOT loaded');
            console.log('- JSZip:', typeof JSZip !== 'undefined' ? 'loaded' : 'NOT loaded');
            console.log('- docx:', typeof docx !== 'undefined' ? 'loaded' : 'NOT loaded');
            if (typeof docx === 'undefined') {
                console.error('docx library failed to load! Check js/docx.umd.js file');
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Medical Doc Converter</h1>
            <p class="subtitle">PDF / PPTX &rarr; DOCX formatÃ©</p>
            <p class="subtitle-small">100% client-side â€” aucun serveur, vos fichiers restent sur votre machine</p>
        </header>

        <input type="file" id="fileInput" accept=".pdf,.pptx" style="display: none;">

        <div class="upload-zone" id="dropZone">
            <div class="upload-icon">ðŸ“„</div>
            <p class="upload-text">Glissez votre fichier ici</p>
            <p class="upload-hint">ou cliquez pour sÃ©lectionner</p>
            <p class="upload-formats">PDF, PPTX â€” max 50 Mo</p>
        </div>

        <div class="file-info" id="fileInfo" style="display:none;">
            <span class="file-name" id="fileName"></span>
            <span class="file-size" id="fileSize"></span>
            <button class="btn-remove" id="removeFile">Ã—</button>
        </div>

        <button class="btn-convert" id="convertBtn" disabled>
            Convertir en DOCX
        </button>

        <div class="progress-container" id="progressContainer" style="display:none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <p class="progress-text" id="progressText">Conversion en cours...</p>
        </div>

        <div class="error-msg" id="errorMsg" style="display:none;"></div>

        <div class="specs">
            <h3>Formatage appliquÃ© automatiquement</h3>
            <ul>
                <li><span class="color-dot" style="background:#E97031"></span> Titre matiÃ¨re â€” 16pt Orange</li>
                <li><span class="color-dot" style="background:#EE0000"></span> Parties principales â€” 12-14pt Rouge</li>
                <li><span class="color-dot" style="background:#00AF50"></span> Sections numÃ©rotÃ©es â€” 11pt Vert</li>
                <li><span class="color-dot" style="background:#006FC0"></span> Sous-sections cliniques â€” 10pt Bleu</li>
                <li><span class="color-dot" style="background:#9F2B92"></span> Labels d'examen â€” 10pt Violet</li>
                <li><span class="color-dot" style="background:#E97031"></span> En-tÃªtes tableaux â€” 10pt Orange</li>
            </ul>
        </div>

        <footer>
            <p>Police : Aptos | Format : A4 | Marges rÃ©duites | Compact</p>
        </footer>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
